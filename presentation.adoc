= DevOps меня полностью
Марат Радченко <https://github.com/slonopotamus[@slonopotamus]>
v1.0, 2020-02-26
:source-highlighter: highlightjs
:revealjs_hash: true
:revealjs_theme: league
:revealjsdir: https://cdn.jsdelivr.net/npm/reveal.js@3.9.2
:icons: font
:highlightjs-languages: groovy

Ломаем билды быстро, гибко и безопасно

**{revdate}**

== !

Эта презентация автоматически компилируется из текстового файла и деплоится в эти ваши интернеты когда я делаю `git push`

=== !

У неё нет билд-менеджера, нет билд-агентов, нет десятков вики-страниц с инструкцией по установке

=== !

Есть условный `build.bat`

[source,ruby]
----
include::Rakefile[]
----

Это _весь_ файл

=== !

И условный `Jenkinsfile`

[source,yaml]
----
include::.github/workflows/ci.yml[]
----

И это тоже _весь_ файл

=== !

Оба файла находятся в репозитории с исходниками

=== Игрушечный пример!

[.step]
* Окей, это всего-лишь презентация
* Игры немного сложнее
* Да, немного

== Предыстория: внутри Allods Team

A1, S1, T1, D1 - тысячи их

* Программисты отдельно от билд-менеджеров
* Билд-скрипты внутри Jenkins, нет доступа
* Тяжеловесные процессы изменений
* "Забор" между pipeline и build.bat
* Влияние веток друг на друга

[.columns]
== Предыстория: внешний мир (open source)

[.column]
--
У проекта есть

* Git-репозиторий
* Issue-tracker
--

[.column]
--
Сторонние сервисы

* Сервис CI
* Сервис для деплоя
* Хранилище релизов
* Вебсайт
--

== Цели

* Прозрачность процессов сборки/деплоя
* Возможность заглянуть внутрь и потыкать палочкой
* Изоляция веток, безопасные эксперименты
* Быстрое внесение изменений в билд-процессы
* Сборка релиза за полчаса

== Пайплайны - это просто

.Разве что-то может пойти не так?
[source,groovy]
----
pipeline
{
    /* insert Declarative Pipeline here */
}
----

== Проблемы Jenkins

* Нет локальной проверки
* Весь функционал в плагинах, которые system-wide
* Нужны админские права даже чтобы создать джоб
* Чудовищный UI/UX

== Планы & мечты

* Изоляция от окружения на билд-агенте
* Билд менее чем за час
* Создание тест-стендов одной кнопкой
* Автоматический деплой билда на клиенты
* Более другой CI-сервис
* Динамический пул агентов

== Q&A

== Source

link:https://github.com/slonopotamus/devops-9000[github.com/slonopotamus/devops-9000]
